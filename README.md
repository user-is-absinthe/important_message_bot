# Бот для важных сообщений

Telegram-бот для **инлайн‑поиска изображений по тегам** с приватным хранилищем в канале и базой для учёта загрузок пользователей.

## Что умеет

- Работает **в inline‑режиме** (`@your_bot ...`): показывает **галерею** по введённым тегам. Пользователь видит **только свои** загруженные изображения.
- **Поиск по тегам** среди **заранее загруженных** изображений.
- Изображения **хранятся в приватном канале**; выдача идёт по **ID сообщения** из канала. На клиенте файлы **не сохраняются**.
- В базе фиксируется, **кто именно** загрузил каждую картинку (user_id ↔ message_id/file_id ↔ теги).
- Если загрузкой является **группа изображений**, всем картинкам проставляются теги из текста описания (общие теги на группу).
- В режиме **диалога с ботом** (личка с ботом) доступны операции:
  1) **Добавить** картинку и теги к ней;
  2) **Редактировать теги** или **удалить** картинку — для этого отправьте картинку боту **через inline‑режим**; бот предложит две кнопки: **«Удалить»** (с подтверждением) и **«Редактировать теги»**.

## Как это устроено

- **Хранилище**: приватный канал Telegram (доступ у бота). Изображения публикуются туда; для выдачи используется **message_id**/ссылки на сообщения.
- **Поиск**: индекс тегов хранится в БД; inline‑запросы собирают релевантную выборку и рендерят превью в статье/галерее.
- **Доступность**: пользователю показываются **только его** изображения (фильтрация по автору загрузки).

## Установка и запуск (локально)

```bash
git clone https://github.com/user-is-absinthe/important_message_bot.git
cd important_message_bot

python -m venv .venv
# Windows: .venv\Scripts\activate
source .venv/bin/activate

pip install -r requirements.txt
```

Скопируйте пример настроек и заполните значения:
```bash
cp example_settings.py settings.py
```

### Конфигурация (основные переменные)

- `BOT_TOKEN` — токен бота от @BotFather;
- `CHANNEL_ID` — ID приватного канала‑хранилища (целое число, обычно вида -100…);
- `DB_PATH` — путь к базе (по умолчанию `photos.db`);
- `BOT_LINK` — username бота без @ (используется для inline и ссылок).

### Запуск

```bash
python bot.py
```

## Требования

- Python 3.10+
- Установленные зависимости из `requirements.txt`

## Лицензия

Проект распространяется по **GNU AGPL‑3.0**. Полный текст — в файле `LICENSE`.
